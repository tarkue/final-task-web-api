# final-task-web-api

Домашняя работа по WebAPI с DDD и работой с HTTP, WebSocket, Nats.

Сейчас доступны следующие эндпоинты

CRUD-эндпоинты по задачам:

- GET /items
- GET /items/:id
- POST /items
- DELETE /items/:id
- PATCH /items/:id

Фоновая задача

- POST /items/run

Websocket при работе с задачами

- WS /ws/items

## Запуск

Перед запуском необходимо создать `.env`-файл с параметрами из .env.example, он необходим для конфигурирования базы данных, подключения к базе данных и настройке FastAPI приложения, также нужно указать эндпоинт для получения тасок из внешнего сервера, с которого будут периодически подтягиваться новые задачи.

### Локально

Если вы запускаете локально, то в .env нужно будет добавить данные для подключения к nats, причём и username, и password.

Можно запустить сервер локально, необходимо установить зависимости либо с помощью uv, либо с помощью pip. Точка входа - `main.py`

#### pip

```bash
pip install -r requirements.txt
python main.py
```

#### uv

```bash
uv sync --locked
uv run python main.py
```

### Внутри Docker

Для запуска в docker нет необходимости указывать данные для подключения к nats, потому что в докере nats работает во внутренней сети nats-network.

Для запуска внутри Docker необходимо воспользоваться командой

```
docker compose up -d --build
```

После неё поднимется два контейнера:

1. nats
2. fastapi (бекенд)
